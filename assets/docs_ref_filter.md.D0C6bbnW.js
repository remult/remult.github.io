import{_ as a,c as n,o as e,L as l}from"./chunks/framework.BLY-PH98.js";const D=JSON.parse('{"title":"Filter","description":"","frontmatter":{},"headers":[],"relativePath":"docs/ref_filter.md","filePath":"docs/ref_filter.md","lastUpdated":1724738315000}'),t={name:"docs/ref_filter.md"};function o(p,s,r,c,i,y){return e(),n("div",null,s[0]||(s[0]=[l(`<h1 id="filter" tabindex="-1">Filter <a class="header-anchor" href="#filter" aria-label="Permalink to &quot;Filter&quot;">​</a></h1><p>The <code>Filter</code> class is a helper class that focuses on filter-related concerns. It provides methods for creating and applying filters in queries.</p><h2 id="getprecisevalues" tabindex="-1">getPreciseValues <a class="header-anchor" href="#getprecisevalues" aria-label="Permalink to &quot;getPreciseValues&quot;">​</a></h2><p>Retrieves precise values for each property in a filter for an entity.</p><h4 id="returns" tabindex="-1">returns: <a class="header-anchor" href="#returns" aria-label="Permalink to &quot;returns:&quot;">​</a></h4><p>A promise that resolves to a FilterPreciseValues object containing the precise values for each property.</p><h4 id="example" tabindex="-1">example: <a class="header-anchor" href="#example" aria-label="Permalink to &quot;example:&quot;">​</a></h4><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki tokyo-night vp-code" style="background-color:#1a1b26;color:#a9b1d6;" tabindex="0"><code><span class="line"><span style="color:#9D7CD8;font-style:italic;">const</span><span style="color:#BB9AF7;"> preciseValues</span><span style="color:#89DDFF;"> =</span><span style="color:#BB9AF7;font-style:italic;"> await</span><span style="color:#C0CAF5;"> Filter</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">getPreciseValues</span><span style="color:#9ABDF5;">(</span><span style="color:#C0CAF5;">meta</span><span style="color:#89DDFF;">,</span><span style="color:#9ABDF5;"> {</span></span>
<span class="line"><span style="color:#73DACA;">  status</span><span style="color:#89DDFF;">:</span><span style="color:#9ABDF5;"> {</span><span style="color:#73DACA;"> $ne</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#9ECE6A;">active</span><span style="color:#89DDFF;">&#39;</span><span style="color:#9ABDF5;"> }</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#73DACA;">  $or</span><span style="color:#89DDFF;">:</span><span style="color:#9ABDF5;"> [</span></span>
<span class="line"><span style="color:#9ABDF5;">    {</span><span style="color:#73DACA;"> customerId</span><span style="color:#89DDFF;">:</span><span style="color:#9ABDF5;"> [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#9ECE6A;">1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#9ECE6A;">2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#9ABDF5;">]</span><span style="color:#9ABDF5;"> }</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#9ABDF5;">    {</span><span style="color:#73DACA;"> customerId</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#9ECE6A;">3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#9ABDF5;"> }</span></span>
<span class="line"><span style="color:#9ABDF5;">  ]</span></span>
<span class="line"><span style="color:#9ABDF5;">})</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C0CAF5;">console</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">log</span><span style="color:#9ABDF5;">(</span><span style="color:#C0CAF5;">preciseValues</span><span style="color:#9ABDF5;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">// Output:</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">// {</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">//   &quot;customerId&quot;: [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;],</span><span style="color:#51597D;font-style:italic;"> // Precise values inferred from the filter</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">//   &quot;status&quot;: undefined,</span><span style="color:#51597D;font-style:italic;">           // Cannot infer precise values for &#39;status&#39;</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">// }</span></span></code></pre></div><p>Arguments:</p><ul><li><strong>metadata</strong> - The metadata of the entity being filtered.</li><li><strong>filter</strong> - The filter to analyze.</li></ul><h2 id="getprecisevalues-1" tabindex="-1">getPreciseValues <a class="header-anchor" href="#getprecisevalues-1" aria-label="Permalink to &quot;getPreciseValues&quot;">​</a></h2><p>Retrieves precise values for each property in a filter for an entity.</p><h4 id="returns-1" tabindex="-1">returns: <a class="header-anchor" href="#returns-1" aria-label="Permalink to &quot;returns:&quot;">​</a></h4><p>A promise that resolves to a FilterPreciseValues object containing the precise values for each property.</p><h4 id="example-1" tabindex="-1">example: <a class="header-anchor" href="#example-1" aria-label="Permalink to &quot;example:&quot;">​</a></h4><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki tokyo-night vp-code" style="background-color:#1a1b26;color:#a9b1d6;" tabindex="0"><code><span class="line"><span style="color:#9D7CD8;font-style:italic;">const</span><span style="color:#BB9AF7;"> preciseValues</span><span style="color:#89DDFF;"> =</span><span style="color:#BB9AF7;font-style:italic;"> await</span><span style="color:#C0CAF5;"> where</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">getPreciseValues</span><span style="color:#9ABDF5;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C0CAF5;">console</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">log</span><span style="color:#9ABDF5;">(</span><span style="color:#C0CAF5;">preciseValues</span><span style="color:#9ABDF5;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">// Output:</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">// {</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">//   &quot;customerId&quot;: [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;],</span><span style="color:#51597D;font-style:italic;"> // Precise values inferred from the filter</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">//   &quot;status&quot;: undefined,</span><span style="color:#51597D;font-style:italic;">           // Cannot infer precise values for &#39;status&#39;</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">// }</span></span></code></pre></div><h2 id="createcustom" tabindex="-1">createCustom <a class="header-anchor" href="#createcustom" aria-label="Permalink to &quot;createCustom&quot;">​</a></h2><p>Creates a custom filter. Custom filters are evaluated on the backend, ensuring security and efficiency. When the filter is used in the frontend, only its name is sent to the backend via the API, where the filter gets translated and applied in a safe manner.</p><h4 id="returns-2" tabindex="-1">returns: <a class="header-anchor" href="#returns-2" aria-label="Permalink to &quot;returns:&quot;">​</a></h4><p>A function that returns an <code>EntityFilter</code> of type <code>entityType</code>.</p><h4 id="example-2" tabindex="-1">example: <a class="header-anchor" href="#example-2" aria-label="Permalink to &quot;example:&quot;">​</a></h4><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki tokyo-night vp-code" style="background-color:#1a1b26;color:#a9b1d6;" tabindex="0"><code><span class="line"><span style="color:#BB9AF7;">class</span><span style="color:#C0CAF5;"> Order</span><span style="color:#9ABDF5;"> {</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;"> //...</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic;"> static</span><span style="color:#73DACA;"> activeOrdersFor</span><span style="color:#89DDFF;"> =</span><span style="color:#C0CAF5;"> Filter</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">createCustom</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C0CAF5;">Order</span><span style="color:#89DDFF;">,</span><span style="color:#9ABDF5;"> {</span><span style="color:#73DACA;"> year</span><span style="color:#89DDFF;">:</span><span style="color:#0DB9D7;"> number</span><span style="color:#9ABDF5;"> }</span><span style="color:#89DDFF;">&gt;</span><span style="color:#9ABDF5;">(</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic;">   async</span><span style="color:#9ABDF5;"> (</span><span style="color:#89DDFF;">{</span><span style="color:#E0AF68;"> year</span><span style="color:#89DDFF;"> }</span><span style="color:#9ABDF5;">)</span><span style="color:#BB9AF7;"> =&gt;</span><span style="color:#9ABDF5;"> {</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic;">     return</span><span style="color:#9ABDF5;"> {</span></span>
<span class="line"><span style="color:#73DACA;">       status</span><span style="color:#89DDFF;">:</span><span style="color:#9ABDF5;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#9ECE6A;">created</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#9ECE6A;">confirmed</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#9ECE6A;">pending</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#9ECE6A;">blocked</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#9ECE6A;">delayed</span><span style="color:#89DDFF;">&#39;</span><span style="color:#9ABDF5;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#73DACA;">       createdAt</span><span style="color:#89DDFF;">:</span><span style="color:#9ABDF5;"> {</span></span>
<span class="line"><span style="color:#73DACA;">         $gte</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> new</span><span style="color:#7AA2F7;"> Date</span><span style="color:#9ABDF5;">(</span><span style="color:#C0CAF5;">year</span><span style="color:#89DDFF;">,</span><span style="color:#FF9E64;"> 0</span><span style="color:#89DDFF;">,</span><span style="color:#FF9E64;"> 1</span><span style="color:#9ABDF5;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#73DACA;">         $lt</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> new</span><span style="color:#7AA2F7;"> Date</span><span style="color:#9ABDF5;">(</span><span style="color:#C0CAF5;">year</span><span style="color:#89DDFF;"> +</span><span style="color:#FF9E64;"> 1</span><span style="color:#89DDFF;">,</span><span style="color:#FF9E64;"> 0</span><span style="color:#89DDFF;">,</span><span style="color:#FF9E64;"> 1</span><span style="color:#9ABDF5;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#9ABDF5;">       }</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#9ABDF5;">     }</span></span>
<span class="line"><span style="color:#9ABDF5;">   }</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#9ABDF5;"> )</span></span>
<span class="line"><span style="color:#9ABDF5;">}</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">// Usage</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic;">await</span><span style="color:#7AA2F7;"> repo</span><span style="color:#9ABDF5;">(</span><span style="color:#C0CAF5;">Order</span><span style="color:#9ABDF5;">)</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">find</span><span style="color:#9ABDF5;">({</span></span>
<span class="line"><span style="color:#73DACA;"> where</span><span style="color:#89DDFF;">:</span><span style="color:#C0CAF5;"> Order</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">activeOrders</span><span style="color:#9ABDF5;">({</span><span style="color:#C0CAF5;"> year</span><span style="color:#9ABDF5;"> })</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#9ABDF5;">})</span></span></code></pre></div><h4 id="see" tabindex="-1">see: <a class="header-anchor" href="#see" aria-label="Permalink to &quot;see:&quot;">​</a></h4><p><a href="/docs/custom-filter.html">Sql filter and Custom filter</a><a href="/docs/filtering-and-relations.html">Filtering and Relations</a></p><p>Arguments:</p><ul><li><strong>translator</strong> - A function that returns an <code>EntityFilter</code>.</li><li><strong>key</strong> - An optional unique identifier for the custom filter.</li></ul><h2 id="entityfiltertojson" tabindex="-1">entityFilterToJson <a class="header-anchor" href="#entityfiltertojson" aria-label="Permalink to &quot;entityFilterToJson&quot;">​</a></h2><p>Translates an <code>EntityFilter</code> to a plain JSON object that can be stored or transported.</p><h4 id="returns-3" tabindex="-1">returns: <a class="header-anchor" href="#returns-3" aria-label="Permalink to &quot;returns:&quot;">​</a></h4><p>A plain JSON object representing the <code>EntityFilter</code>.</p><h4 id="example-3" tabindex="-1">example: <a class="header-anchor" href="#example-3" aria-label="Permalink to &quot;example:&quot;">​</a></h4><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki tokyo-night vp-code" style="background-color:#1a1b26;color:#a9b1d6;" tabindex="0"><code><span class="line"><span style="color:#51597D;font-style:italic;">// Assuming \`Task\` is an entity class</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic;">const</span><span style="color:#BB9AF7;"> jsonFilter</span><span style="color:#89DDFF;"> =</span><span style="color:#C0CAF5;"> Filter</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">entityFilterToJson</span><span style="color:#9ABDF5;">(</span><span style="color:#C0CAF5;">Task</span><span style="color:#89DDFF;">,</span><span style="color:#9ABDF5;"> {</span><span style="color:#73DACA;"> completed</span><span style="color:#89DDFF;">:</span><span style="color:#FF9E64;"> true</span><span style="color:#9ABDF5;"> })</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">// \`jsonFilter\` can now be stored or transported as JSON</span></span></code></pre></div><p>Arguments:</p><ul><li><strong>entityDefs</strong> - The metadata of the entity associated with the filter.</li><li><strong>where</strong> - The <code>EntityFilter</code> to be translated.</li></ul><h2 id="entityfilterfromjson" tabindex="-1">entityFilterFromJson <a class="header-anchor" href="#entityfilterfromjson" aria-label="Permalink to &quot;entityFilterFromJson&quot;">​</a></h2><p>Translates a plain JSON object back into an <code>EntityFilter</code>.</p><h4 id="returns-4" tabindex="-1">returns: <a class="header-anchor" href="#returns-4" aria-label="Permalink to &quot;returns:&quot;">​</a></h4><p>The reconstructed <code>EntityFilter</code>.</p><h4 id="example-4" tabindex="-1">example: <a class="header-anchor" href="#example-4" aria-label="Permalink to &quot;example:&quot;">​</a></h4><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki tokyo-night vp-code" style="background-color:#1a1b26;color:#a9b1d6;" tabindex="0"><code><span class="line"><span style="color:#51597D;font-style:italic;">// Assuming \`Task\` is an entity class and \`jsonFilter\` is a JSON object representing an EntityFilter</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic;">const</span><span style="color:#BB9AF7;"> taskFilter</span><span style="color:#89DDFF;"> =</span><span style="color:#C0CAF5;"> Filter</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">entityFilterFromJson</span><span style="color:#9ABDF5;">(</span><span style="color:#C0CAF5;">Task</span><span style="color:#89DDFF;">,</span><span style="color:#C0CAF5;"> jsonFilter</span><span style="color:#9ABDF5;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">// Using the reconstructed \`EntityFilter\` in a query</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic;">const</span><span style="color:#BB9AF7;"> tasks</span><span style="color:#89DDFF;"> =</span><span style="color:#BB9AF7;font-style:italic;"> await</span><span style="color:#C0CAF5;"> remult</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">repo</span><span style="color:#9ABDF5;">(</span><span style="color:#C0CAF5;">Task</span><span style="color:#9ABDF5;">)</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">find</span><span style="color:#9ABDF5;">({</span><span style="color:#73DACA;"> where</span><span style="color:#89DDFF;">:</span><span style="color:#C0CAF5;"> taskFilter</span><span style="color:#9ABDF5;"> })</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BB9AF7;">for</span><span style="color:#9ABDF5;"> (</span><span style="color:#9D7CD8;font-style:italic;">const</span><span style="color:#BB9AF7;"> task</span><span style="color:#89DDFF;"> of</span><span style="color:#C0CAF5;"> tasks</span><span style="color:#9ABDF5;">)</span><span style="color:#9ABDF5;"> {</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">  // Do something for each task based on the filter</span></span>
<span class="line"><span style="color:#9ABDF5;">}</span></span></code></pre></div><p>Arguments:</p><ul><li><strong>entityDefs</strong> - The metadata of the entity associated with the filter.</li><li><strong>packed</strong> - The plain JSON object representing the <code>EntityFilter</code>.</li></ul><h2 id="fromentityfilter" tabindex="-1">fromEntityFilter <a class="header-anchor" href="#fromentityfilter" aria-label="Permalink to &quot;fromEntityFilter&quot;">​</a></h2><p>Converts an <code>EntityFilter</code> to a <code>Filter</code> that can be used by the <code>DataProvider</code>. This method is mainly used internally.</p><h4 id="returns-5" tabindex="-1">returns: <a class="header-anchor" href="#returns-5" aria-label="Permalink to &quot;returns:&quot;">​</a></h4><p>A <code>Filter</code> instance that can be used by the <code>DataProvider</code>.</p><h4 id="example-5" tabindex="-1">example: <a class="header-anchor" href="#example-5" aria-label="Permalink to &quot;example:&quot;">​</a></h4><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki tokyo-night vp-code" style="background-color:#1a1b26;color:#a9b1d6;" tabindex="0"><code><span class="line"><span style="color:#51597D;font-style:italic;">// Assuming \`Task\` is an entity class and \`taskFilter\` is an EntityFilter</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic;">const</span><span style="color:#BB9AF7;"> filter</span><span style="color:#89DDFF;"> =</span><span style="color:#C0CAF5;"> Filter</span><span style="color:#89DDFF;">.</span><span style="color:#7AA2F7;">fromEntityFilter</span><span style="color:#9ABDF5;">(</span><span style="color:#C0CAF5;">Task</span><span style="color:#89DDFF;">,</span><span style="color:#C0CAF5;"> taskFilter</span><span style="color:#9ABDF5;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#51597D;font-style:italic;">// \`filter\` can now be used with the DataProvider</span></span></code></pre></div><p>Arguments:</p><ul><li><strong>entity</strong> - The metadata of the entity associated with the filter.</li><li><strong>whereItem</strong> - The <code>EntityFilter</code> to be converted.</li></ul><h2 id="constructor" tabindex="-1">constructor <a class="header-anchor" href="#constructor" aria-label="Permalink to &quot;constructor&quot;">​</a></h2><ul><li><strong>new Filter</strong></li></ul><p>Arguments:</p><ul><li><strong>apply</strong></li></ul><h2 id="resolve" tabindex="-1">resolve <a class="header-anchor" href="#resolve" aria-label="Permalink to &quot;resolve&quot;">​</a></h2><p>Resolves an entity filter.</p><p>This method takes a filter which can be either an instance of <code>EntityFilter</code> or a function that returns an instance of <code>EntityFilter</code> or a promise that resolves to an instance of <code>EntityFilter</code>. It then resolves the filter if it is a function and returns the resulting <code>EntityFilter</code>.</p><h4 id="returns-6" tabindex="-1">returns: <a class="header-anchor" href="#returns-6" aria-label="Permalink to &quot;returns:&quot;">​</a></h4><p>The resolved entity filter.</p><p>Arguments:</p><ul><li><strong>filter</strong> - The filter to resolve.</li></ul><h2 id="tojson" tabindex="-1">toJson <a class="header-anchor" href="#tojson" aria-label="Permalink to &quot;toJson&quot;">​</a></h2><ul><li><strong>toJson</strong></li></ul>`,63)]))}const d=a(t,[["render",o]]);export{D as __pageData,d as default};
