import{_ as s,c as a,o as n,a5 as e}from"./chunks/framework.C7bC4sbb.js";const u=JSON.parse('{"title":"Required","description":"","frontmatter":{"type":"lesson","title":"Required","focus":"/shared/Task.ts"},"headers":[],"relativePath":"interactive/src/content/tutorial/1-basics/4-validation/1-required/content.md","filePath":"interactive/src/content/tutorial/1-basics/4-validation/1-required/content.md","lastUpdated":1723988490000}'),o={name:"interactive/src/content/tutorial/1-basics/4-validation/1-required/content.md"},t=e(`<h1 id="validation-introduction" tabindex="-1">Validation Introduction <a class="header-anchor" href="#validation-introduction" aria-label="Permalink to &quot;Validation Introduction&quot;">​</a></h1><p>In most web applications, validation code is spread and duplicated across multiple places. You need frontend validation, and you need API validation, all in various forms, controllers, routes, and services.</p><p>It&#39;s very hard to get validations right across the entire application, and often you&#39;ll run into validation errors on the API that do not display gracefully on the frontend. Even worse, validation that is done only on the frontend can be bypassed by calling the API directly.</p><p>Remult handles that concern with the SSO (Single Source of Truth) approach, where you define your validation once—in your entity—and that validation code runs both on the frontend and the API, ensuring consistent validation across the stack.</p><h2 id="required-validation" tabindex="-1">Required Validation <a class="header-anchor" href="#required-validation" aria-label="Permalink to &quot;Required Validation&quot;">​</a></h2><p>Let&#39;s start with a simple <code>required</code> validation.</p><p>Adjust the <code>title</code> field to be <code>required</code>:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> class</span><span style="color:#4EC9B0;"> Task</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">  @</span><span style="color:#9CDCFE;">Fields</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">uuid</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#9CDCFE;">  id</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;&#39;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#D4D4D4;">  @</span><span style="color:#9CDCFE;">Fields</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">string</span><span style="color:#D4D4D4;">({</span></span>
<span class="line highlighted"><span style="color:#9CDCFE;">    required:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span>
<span class="line highlighted"><span style="color:#D4D4D4;">  })</span></span>
<span class="line"><span style="color:#9CDCFE;">  title</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">  //....</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span></code></pre></div><h3 id="code-explanation" tabindex="-1">Code Explanation <a class="header-anchor" href="#code-explanation" aria-label="Permalink to &quot;Code Explanation&quot;">​</a></h3><ul><li>We added the <code>required: true</code> option to the <code>title</code> field using the <code>@Fields.string</code> decorator.</li><li>This ensures that the <code>title</code> field is required and cannot be empty.</li></ul><h3 id="validation-behavior" tabindex="-1">Validation Behavior <a class="header-anchor" href="#validation-behavior" aria-label="Permalink to &quot;Validation Behavior&quot;">​</a></h3><ul><li>This validation will be first checked on the frontend, without making an API call (frontend validation).</li><li>The same validation will also be executed on the API, ensuring consistency across the stack.</li></ul><p>Try adding a task with no title to see the validation in action.</p><p>Also - checkout the browser&#39;s network tab, and see that there is no network call to the backend - the validation is performed in the frontend.</p><blockquote><p><strong>Note:</strong> In this tutorial, the errors appear in the browser&#39;s alert dialog as specified in the code in our <code>Todo.tsx</code> component:</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">async</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> addTask</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">FormEvent</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#9CDCFE;">  e</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">preventDefault</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#C586C0;">  try</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> newTask</span><span style="color:#D4D4D4;"> = </span><span style="color:#C586C0;">await</span><span style="color:#9CDCFE;"> taskRepo</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">insert</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">title:</span><span style="color:#9CDCFE;"> newTaskTitle</span><span style="color:#D4D4D4;"> })</span></span>
<span class="line"><span style="color:#DCDCAA;">    setTasks</span><span style="color:#D4D4D4;">([...</span><span style="color:#9CDCFE;">tasks</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">newTask</span><span style="color:#D4D4D4;">])</span></span>
<span class="line"><span style="color:#DCDCAA;">    setNewTaskTitle</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;&#39;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">  } </span><span style="color:#C586C0;">catch</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">error</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">any</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line highlighted"><span style="color:#DCDCAA;">    alert</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">error</span><span style="color:#C586C0;"> as</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">message</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> }).</span><span style="color:#9CDCFE;">message</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">  }</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span></code></pre></div></blockquote><hr><p>When an error occurs, it returns an error of type <code>ErrorInfo&lt;Task&gt;</code> that specifies the error for each field, allowing you to create a great UI where the error for a field is displayed next to its input.</p><p>Here&#39;s an example of the error response:</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#9CDCFE;">  &quot;message&quot;</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;Title: Should not be empty&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  &quot;modelState&quot;</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;">    &quot;title&quot;</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;Should not be empty&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">  }</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span></code></pre></div><p>This ensures that the validation error is clear and can be displayed appropriately in the UI.</p><h3 id="validation-on-the-api" tabindex="-1">Validation on the Api <a class="header-anchor" href="#validation-on-the-api" aria-label="Permalink to &quot;Validation on the Api&quot;">​</a></h3><p>The same validation code that runs in the frontend, is also used to validate the api - if anyone tries to send an invalid request to the api they&#39;ll fail.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>You can try and bypass the frontend validation, by making a post call directly from the browser&#39;s console.</p><p>Right click on the <code>preview</code> window, and select <code>inspect</code>, you&#39;ll be able to run the api call directly from the developer tools console (at least on chrome)</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#C586C0;">await</span><span style="color:#DCDCAA;"> fetch</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;/api/tasks&#39;</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">method:</span><span style="color:#CE9178;"> &#39;POST&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">body:</span><span style="color:#CE9178;"> &#39;&#39;</span><span style="color:#D4D4D4;"> }).</span><span style="color:#DCDCAA;">then</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">r</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> r</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">json</span><span style="color:#D4D4D4;">())</span></span></code></pre></div><p>See the result error object that&#39;s returned</p></div>`,23),l=[t];function p(r,i,c,d,D,y){return n(),a("div",null,l)}const C=s(o,[["render",p]]);export{u as __pageData,C as default};
